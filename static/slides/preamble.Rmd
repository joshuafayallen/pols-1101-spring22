```{R, setup, include = F, warnings = FALSE, cache = TRUE}

devtools::install_github("gadenbuie/xaringanExtra")
devtools::install_github("gadenbuie/countdown")

pacman::p_load("tidyverse", "patchwork", "modelsummary", "ggridges", "kableExtra",
               "gameofthrones", "MetBrewer", "viridis", "here", "lubridate",
               "stevemisc", "xaringanExtra", "flair", "countdown")



if(!require("showtext")) {
  print("Install the package `showtext`.")
} else {
  library("showtext")
  showtext_auto()
  font_add_google("Fira Sans", "fira_sans")
  font_add_google("Roboto Condensed", "Roboto Condensed")
  font_add_google("IBM Plex Sans", "IBM")
}

theme_allen = function(title_pos = "center", axis_title_pos = "left", 
                       slides = FALSE, has_subtitle = FALSE, 
                       base_size = 14, ...){
  
  title_hjust <- switch(title_pos, "center" = 0.5, "left" = 0)
  axis_title_hjust_y <- switch(axis_title_pos, "center" = 0.5, "left" = 1.0)
  axis_title_hjust_x <- switch(axis_title_pos, "center" = 0.5, "left" = 0.0)
  plot_bg = if_else(slides, "#ECECEC", "transparent")
  plot_grid = if_else(slides, "grey85", "grey92")
  title_margin = if_else(has_subtitle, "4", "16")
  
  
 ggthemes:: theme_clean(base_family = "Roboto Condensed", 
                base_size = base_size)  +
    theme(axis.ticks = element_line(colour='black'),
          plot.background = element_blank(),
          plot.title = ggplot2::element_text(
            # Font
            family = "IBM", face = "bold", size = rel(1.285), 
            colour = "#454545", 
            # Center title
            hjust = title_hjust,
            # Margins
            margin = ggplot2::margin(b = title_margin, unit = "pt")
          ),
          plot.subtitle = element_text(
            family = "IBM", face = "bold", size = rel(1.285), 
            colour = "#454545", 
            # Center title
            hjust = title_hjust,
            # Margins
            margin = ggplot2::margin(b = title_margin, unit = "pt")
          ),
          panel.grid.minor = element_blank(),
          panel.grid.major = element_line(linetype = "dotted", 
                                          color = "#BBBBBB"),
          axis.title.y = ggplot2::element_text(
            # Right-align y axis title
            hjust = axis_title_hjust_y,
            # Margins
            margin = ggplot2::margin(r = 10)
          ),
          axis.title.x = ggplot2::element_text(
            # Left-align x axis title
            hjust = axis_title_hjust_x,
            # Margins
            margin = ggplot2::margin(t = 10)
          ),
          # Axis labels
          axis.text = ggplot2::element_text(
            # Font
            size = rel(.72), colour = "#212121"
          ),
          panel.border = element_rect(color = "grey90", fill = NA),
          legend.title = ggplot2::element_text(
            # Font
            size = rel(.86), colour = "#454545"
          ),
          # Legend labels
          legend.text = ggplot2::element_text(
            # Font
            size = rel(.72), colour = "#454545"
          ),
          legend.background = ggplot2::element_rect(
            # No Background Colour
            fill = "transparent", colour = NA
          ),
          legend.key = ggplot2::element_rect(
            # No Background Colour
            fill = "transparent", colour = NA
          ),
          strip.text = ggplot2::element_text(
            # Font 
            size = rel(.86), colour = "#454545", 
            # Margin							   
            margin = ggplot2::margin(t= 10, b= 10)
          ),
          strip.background = ggplot2::element_rect(
            # No Background Colour
            fill = "transparent", colour = NA
          ))
  
}


##knitr stuff
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)

xaringanExtra::use_panelset()
xaringanExtra::use_share_again()
xaringanExtra::style_share_again()
xaringanExtra::use_tachyons()

```

```{css, echo = F, code=xfun::read_utf8(here::here("gsu-css","gsu.css"))}
```

```{css, echo = F, code=xfun::read_utf8(here::here("gsu-css","gsu-fonts.css"))}
```




